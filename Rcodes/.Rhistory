library("ggplot2")
library(Rmisc)
mu_df_SE <- summarySE(
mu_df,
measurevar = 'Mobility', groupvars = 'Treatment'
) # summarizes df by each treatment and replicate
mu_df_SE %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot( aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat="identity", position=position_dodge(), fill=NA, colour='black') +
geom_errorbar(aes(ymin=(Mobility-sd)*1e9, ymax=(Mobility+sd)*1e9), width=.2) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
setwd(paste(path,"figs",sep="/"))
ggsave('mobility.eps', width = 4, height = 3.5, units = "in")
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 12/28/21
# Continued from "create_df.R" THEN "lm.R"
# Plots mean+-sd of EK mobility by each treatment
library("ggplot2")
library(Rmisc)
mu_df_SE <- summarySE(
mu_df,
measurevar = 'Mobility', groupvars = 'Treatment'
) # summarizes df by each treatment and replicate
mu_df_SE %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot( aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat="identity", position=position_dodge(), fill=NA, colour='black') +
geom_errorbar(aes(ymin=(Mobility-sd)*1e9, ymax=(Mobility+sd)*1e9), width=.2) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
library(tidyverse)
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 12/28/21
# Continued from "create_df.R" THEN "lm.R"
# Plots mean+-sd of EK mobility by each treatment
library("ggplot2")
library(Rmisc)
mu_df_SE <- summarySE(
mu_df,
measurevar = 'Mobility', groupvars = 'Treatment'
) # summarizes df by each treatment and replicate
mu_df_SE %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot( aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat="identity", position=position_dodge(), fill=NA, colour='black') +
geom_errorbar(aes(ymin=(Mobility-sd)*1e9, ymax=(Mobility+sd)*1e9), width=.2) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df_SE %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot( aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat="identity", position=position_dodge(), fill=NA, colour='black') +
# geom_errorbar(aes(ymin=(Mobility-sd)*1e9, ymax=(Mobility+sd)*1e9), width=.2) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
getwd()
write.csv(mu_df, "/Users/hk/Desktop/LEMI/SFA/Electrokinetics/codes/2021-12-31.csv")
write.csv(mu_df, "/Users/hk/Desktop/LEMI/SFA/Electrokinetics/codes/2021-12-31.csv", col.names=FALSE)
write.csv(mu_df, "/Users/hk/Desktop/LEMI/SFA/Electrokinetics/codes/2021-12-31.csv", row.names=FALSE)
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=mobility * 1e9)) +
geom_bar(stat = "summary", fun.y = "mean", color = 'black', size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
library(tidyverse)
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=mobility * 1e9)) +
geom_bar(stat = "summary", fun.y = "mean", color = 'black', size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun.y = "mean", color = 'black', size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill='grey')) +
geom_bar(stat = "summary", fun.y = "mean", color = 'black', size = 0.2, width = 0.75)
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun.y = "mean", color = 'black', size = 0.2, width = 0.75)
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun.y = "mean", size = 0.2, width = 0.75)
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75)
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill=NA)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill='white')) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, colour='white')) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill='snow')) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill=NA, colour='black')) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill='whilte', colour='black')) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, colour='white')) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill='white')) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill='white')) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
View(mu_df)
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, rep=Replicate)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill=Replicate)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=trts)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill=Replicate)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill=Replicate)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
setwd(paste(path,"figs",sep="/"))
ggsave('mobility_v2.eps', width = 4, height = 3.5, units = "in")
path
write.csv(mu_df, paste(path,"/",date,"_mu.csv",row.names=FALSE))
write.csv(mu_df, paste(path,"/",date,"_mu.csv",sep="",row.names=FALSE))
write.csv(mu_df, paste(path,"/",date,"_mu.csv",sep=""),row.names=FALSE))
write.csv(mu_df, paste(path,"/",date,"_mu.csv",sep=""),row.names=FALSE)
mu_df$date <- date
write.csv(mu_df, paste(path,"/",date,"_mu.csv",sep=""),row.names=FALSE)
# Created by Hyungseok Kim (hskimm@mit.edu), last run on 1/4/22
# 2021-12-28: copied from DEP-LPS project
library("ggplot2")
library(tidyverse)
rm(list=ls())
## import and clean
date = '2021-12-22'
path <- paste("/Users/hk/Desktop/LEMI/SFA/Electrokinetics/", date, " Pt mobility 3", sep="")
setwd(path)
filename = paste("info_",date,".txt",sep="")
rd_info = read.delim(filename,sep = ",",header=TRUE,dec = ".")
setwd(paste(path,"vy",sep="/"))
df = data.frame(Treatment=factor(), Voltage=double(), Replicate=factor(), Velocity=double()) # use only when beginning from scratch
for (ind in 1:nrow(rd_info)) {
if (rd_info$'channel'[ind]>14) next # consider QW#1 device only this time
str = sprintf("%s_R%d_Ch%02d_TR_%02dV_20X_001.ome.csv", rd_info$'cond'[ind],
rd_info$'rep'[ind], rd_info$'channel'[ind], rd_info$'voltage'[ind])
rd = read.delim(str, header=TRUE, dec = ".")
for (i in 1:dim(rd)[1]) {
df_temp <- data.frame(
Treatment = rd_info$'cond'[ind],
Voltage = rd_info$'voltage'[ind],
Replicate = rd_info$'rep'[ind],
Velocity = rd$'velocity'[i])
df <- rbind(df, df_temp)
}
}
df$"Replicate" <- as.factor(df$"Replicate")
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 12/28/21
# Continued from create_df.R
# Generates linear model to obtain regression coefficient for mobility
# Parameters = Voltage (float), Replicate (categorical), (Treatment (categorical))
df$"Replicate" <- as.factor(df$"Replicate") # Replicate into categorical variables
eps_r = 80; # relative permitivity []
eps_0 = 8.854e-12; # vacuum permitivity [F/m]
eta = 8.66e-4; # viscosity [Pa-s]
l = 10e-3; # channel length [m]
# subset df and loop
trts = c('Ax','+13C1','+1R1')
reps = c(1,2,3)
mu_avg <- c()
for (trt in trts){ # for statistical analysis
df_trt <- df[df$Treatment==trt,]
res <- lm(Velocity ~ Voltage + Replicate, data = df_trt) # build linear model
print(summary(res))
coef = res$coefficients[[2]] # [µm / V-s]
mu_avg  <- append(mu_avg, coef * l * 1e-6) # averaged mobility based on regression coefficient
# zeta = mu * eta / (eps_r * eps_0) # not until EO is excluded
}
mu_df <- data.frame(Treatment=factor(), Replicate=factor(), Mobility=double())
for (trt in trts){ # for passing into "plot_all.R"
for (rep in reps){
df_trt_rep <- df[(df$Treatment==trt)&(df$Replicate==rep),]
res <- lm(Velocity ~ Voltage, data = df_trt_rep)
coef <- res$coefficients[[2]] # [µm / V-s]
mu <- coef * l * 1e-6 # [m2 / V-s]
mu_df_temp <- data.frame(
Treatment = trt,
Replicate = rep,
Mobility = mu
)
mu_df <- rbind(mu_df, mu_df_temp)
}
}
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 12/28/21
# Continued from create_df.R
library("ggplot2")
library(tidyverse)
# subset df by each treatment
trt = 'Ax'
df_trt <- df[df$Treatment==trt,]
df_trt$"Voltage" <- as.factor(df_trt$"Voltage")
df_trt$"Replicate" <- as.factor(df_trt$"Replicate")
# create a boxplot, grouped by voltage
ggplot(df_trt, aes(x=Voltage, y=Velocity, colour=Replicate)) +
geom_boxplot() +
# geom_point(position=position_jitterdodge())
labs(title=trt, x="Voltage (V)", y = "Velocity (µm/s)")
setwd(paste(path,"figs",sep="/"))
ggsave(paste(trt,".eps", sep=""), width = 5, height = 4, units = "in")
# stat test
# i = 3; j = 4;
# g1 = df$Value[df[,1]==trt[i]]
# g2 = df$Value[df[,1]==trt[j]]
# res <- t.test(g1, g2, alternative='two.sided', paired=FALSE)
# sprintf("t test %s vs %s",trt[i],trt[j])
# print(res)
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 12/28/21
# Continued from create_df.R
library("ggplot2")
library(tidyverse)
# subset df by each treatment
trt = '+13C1'
df_trt <- df[df$Treatment==trt,]
df_trt$"Voltage" <- as.factor(df_trt$"Voltage")
df_trt$"Replicate" <- as.factor(df_trt$"Replicate")
# create a boxplot, grouped by voltage
ggplot(df_trt, aes(x=Voltage, y=Velocity, colour=Replicate)) +
geom_boxplot() +
# geom_point(position=position_jitterdodge())
labs(title=trt, x="Voltage (V)", y = "Velocity (µm/s)")
setwd(paste(path,"figs",sep="/"))
ggsave(paste(trt,".eps", sep=""), width = 5, height = 4, units = "in")
# stat test
# i = 3; j = 4;
# g1 = df$Value[df[,1]==trt[i]]
# g2 = df$Value[df[,1]==trt[j]]
# res <- t.test(g1, g2, alternative='two.sided', paired=FALSE)
# sprintf("t test %s vs %s",trt[i],trt[j])
# print(res)
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 12/28/21
# Continued from create_df.R
library("ggplot2")
library(tidyverse)
# subset df by each treatment
trt = '+1R1'
df_trt <- df[df$Treatment==trt,]
df_trt$"Voltage" <- as.factor(df_trt$"Voltage")
df_trt$"Replicate" <- as.factor(df_trt$"Replicate")
# create a boxplot, grouped by voltage
ggplot(df_trt, aes(x=Voltage, y=Velocity, colour=Replicate)) +
geom_boxplot() +
# geom_point(position=position_jitterdodge())
labs(title=trt, x="Voltage (V)", y = "Velocity (µm/s)")
setwd(paste(path,"figs",sep="/"))
ggsave(paste(trt,".eps", sep=""), width = 5, height = 4, units = "in")
# stat test
# i = 3; j = 4;
# g1 = df$Value[df[,1]==trt[i]]
# g2 = df$Value[df[,1]==trt[j]]
# res <- t.test(g1, g2, alternative='two.sided', paired=FALSE)
# sprintf("t test %s vs %s",trt[i],trt[j])
# print(res)
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 12/28/21
# Continued from "create_df.R" THEN "lm.R"
# Plots mean+-sd of EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
# mu_df_SE <- summarySE(
#   mu_df,
#   measurevar = 'Mobility', groupvars = 'Treatment'
#   ) # summarizes df by each treatment and replicate
#
# mu_df_SE %>%
#   mutate(Treatment = factor(Treatment, levels=trts)) %>%
#   ggplot( aes(x=Treatment, y=Mobility * 1e9)) +
#     geom_bar(stat="identity", position=position_dodge(), fill=NA, colour='black') +
#     # geom_errorbar(aes(ymin=(Mobility-sd)*1e9, ymax=(Mobility+sd)*1e9), width=.2) +
#     geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
#     labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill=Replicate)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df$date <- date
write.csv(mu_df, paste(path,"/",date,"_mu.csv",sep=""),row.names=FALSE)
path
row.names(mu_df)
col.names(mu_df)
col_names(mu_df)
names(mu_df)
colnames(mu_df)
mu_df_all <- data.frame()
names(mu_df_all) <- colnames(mu_df)
rep(0, 2*2)
mu_df_all <- data.frame(matrix(rep(0,4)))
names(mu_df_all) <- colnames(mu_df)
View(mu_df_all)
mu_df_all <- data.frame(matrix(rep(0,4), nrow=1))
names(mu_df_all) <- colnames(mu_df)
mu_df_temp = read.csv(paste(path,"/",date,"_mu.csv",sep=""))
setwd("/Users/hk/Desktop/LEMI/SFA/Electrokinetics")
path <- getwd()
mu_df_temp = read.csv(paste(path,"/",date,"_mu.csv",sep=""))
setwd("/Users/hk/Desktop/LEMI/SFA/Electrokinetics/code")
path <- getwd()
mu_df_temp = read.csv(paste(path,"/",date,"_mu.csv",sep=""))
setwd("/Users/hk/Desktop/LEMI/SFA/Electrokinetics/code")
path <- getwd()
setwd("/Users/hk/Desktop/LEMI/SFA/Electrokinetics/codes")
path <- getwd()
mu_df_temp = read.csv(paste(path,"/",date,"_mu.csv",sep=""))
mu_df_all <- rbind(mu_df_all, mu_df_temp)
setwd("/Users/hk/Desktop/LEMI/SFA/Electrokinetics/codes")
path <- getwd()
dates = c('2021-12-22', '2021-12-31')
mu_df_all <- data.frame(matrix(rep(0,4), nrow=1))
names(mu_df_all) <- colnames(mu_df)
for (date in dates){
mu_df_temp = read.csv(paste(path,"/",date,"_mu.csv",sep=""))
mu_df_all <- rbind(mu_df_all, mu_df_temp)
}
View(mu_df_all)
mu_df_all[2,]
mu_df_all[~2,]
mu_df_all[-2,]
mu_df_all <- mu_df_all[-1,]
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
geom_bar(stat = "identity", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black')
mu_df_SE <- summarySE(mu_df_all, measurevar = 'Mobility', groupvars = c('Treatment','date'))
View(mu_df_SE)
ggplot(mu_df_SE, aes(x=Treatment, y=Mobility*1e9, fill=date)) +
geom_bar(stat='identity', position=position_dodge()) +
geom_point(position=position_jitterdodge())
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot() +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75,
position = position_dodge(),
aes(x=Treatment, y=Mobility * 1e9, fill=Replicate)) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3),
aes(x=Treatment, y=Mobility * 1e9, fill=Replicate)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot() +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75,
position = position_dodge(),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df_all$date=='2021-12-22'
mu_df_all$date[mu_df_all$date=='2021-12-22',]
mu_df_all$date[mu_df_all$date=='2021-12-22']
mu_df_all$date[mu_df_all$date=='2021-12-22'] <- 'log (5 d)'
mu_df_all$date[mu_df_all$date=='2021-12-31'] <- 'stat (14 d)'
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot() +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75,
position = position_dodge(),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')), fill='Growth stage')
path
ggsave('mobility_all.eps', width = 4, height = 3.5, units = "in")
ggsave('mobility_all.eps', width = 6, height = 3.5, units = "in")
mu_df_all$Treatment[mu_df_all$Treatment=='Ax'] <- 'Axenic'
mu_df_all$Treatment[mu_df_all$Treatment=='+1R1'] <- 'ARW1R1'
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot() +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75,
position = position_dodge(),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
labs(x='Culture', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')), fill='Growth stage')
ggsave('mobility_all.eps', width = 6, height = 3.5, units = "in")
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot() +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75,
position = position_dodge(),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
labs(x='Culture', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')), fill='Growth stage')
ggsave('mobility_all.eps', width = 6, height = 3.5, units = "in")
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=c('Axenic', '+13C1', '+ARW1R1'))) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot() +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75,
position = position_dodge(),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
labs(x='Culture', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')), fill='Growth stage')
ggsave('mobility_all.eps', width = 6, height = 3.5, units = "in")
mu_df_all$Treatment[mu_df_all$Treatment=='+1R1'] <- '+ARW1R1'
setwd("/Users/hk/Desktop/LEMI/SFA/Electrokinetics/codes")
path <- getwd()
dates = c('2021-12-22', '2021-12-31')
mu_df_all <- data.frame(matrix(rep(0,4), nrow=1))
names(mu_df_all) <- colnames(mu_df)
for (date in dates){
mu_df_temp = read.csv(paste(path,"/",date,"_mu.csv",sep=""))
mu_df_all <- rbind(mu_df_all, mu_df_temp)
}
mu_df_all <- mu_df_all[-1,]
mu_df_all$Treatment[mu_df_all$Treatment=='Ax'] <- 'Axenic'
mu_df_all$Treatment[mu_df_all$Treatment=='+1R1'] <- '+ARW1R1'
mu_df_all$date[mu_df_all$date=='2021-12-22'] <- 'log (5 d)'
mu_df_all$date[mu_df_all$date=='2021-12-31'] <- 'stat (14 d)'
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=c('Axenic', '+13C1', '+ARW1R1'))) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot() +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75,
position = position_dodge(),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
labs(x='Culture', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')), fill='Growth stage')
ggsave('mobility_all.eps', width = 6, height = 3.5, units = "in")
mu_df_all %>%
mutate(Treatment = factor(Treatment, levels=c('Axenic', '+13C1', '+ARW1R1'))) %>%
mutate(Replicate = factor(Replicate, levels=reps)) %>%
ggplot() +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75,
position = position_dodge(),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.1),
aes(x=Treatment, y=Mobility * 1e9, fill=date)) +
labs(x='Culture', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')), fill='Growth stage')
ggsave('mobility_all.eps', width = 6, height = 3.5, units = "in")
