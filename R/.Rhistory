# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from create_df.R
# Generates linear model to obtain regression coefficient for mobility
# Parameters = Voltage (float), Replicate (categorical), (Treatment (categorical))
eps_r = 80; # relative permitivity []
eps_0 = 8.854e-12; # vacuum permitivity [F/m]
eta = 8.66e-4; # viscosity [Pa-s]
l = 10e-3; # channel length [m]
# subset df and loop
trts = c('3-2', '13C1', 'ARW1R1')
reps = c('1')
chls = c('1','2','4','5','6','8','9','11','13','16')
setwd(paste(path,'figs',sep='/'))
mu_df <- data.frame(Treatment=factor(), Replicate=factor(), Channel=factor(), Mobility=double())
for (chl in chls){ # for passing into "plot_all.R"
trt <- rd_info$cond[rd_info$channel==chl][1]
rep <- reps[1]
df_stat <- df[(df$Channel==chl),]
str <- sprintf("lm_%s_R%s_Ch%02d.txt", trt, rep, as.numeric(chl))
res <- lm(Velocity ~ Voltage, data = df_stat)
summary(res)
sink(str)
print(summary(res))
sink()
coef <- res$coefficients[[2]] # [µm / V-s]
mu <- coef * l * 1e-6 # [m2 / V-s]
mu_df_temp <- data.frame(
Date = date,
Strain = trt,
Replicate = rep,
Channel = chl,
Mobility = mu
)
mu_df <- rbind(mu_df, mu_df_temp)
}
write.table(mu_df, "summ_ek.txt", sep=',', row.names = FALSE)
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from create_df.R
library("ggplot2")
library(tidyverse)
# subset df by each treatment
trt = '3-2'
df_p <- df[(df$Treatment==trt),]
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from create_df.R
library("ggplot2")
library(tidyverse)
# subset df by each treatment
trt = '3-2'
df_p <- df[(df$Treatment==trt),]
df_p$"Voltage" <- as.factor(df_p$"Voltage")
df_p$"Replicate" <- as.factor(df_p$"Replicate")
# create a boxplot, grouped by voltage
ggplot(df_p, aes(x=Voltage, y=Velocity, colour=Channel)) +
geom_boxplot() +
# geom_point(position=position_jitterdodge())
labs(title=paste("Bacterial strain",trt,sep=" "), x="Voltage (V)", y = "Velocity (µm/s)")
# setwd(paste(path,"figs",sep="/"))
ggsave(paste(trt,".eps", sep=""), width = 5, height = 4, units = "in")
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from create_df.R
library("ggplot2")
library(tidyverse)
# subset df by each treatment
trt = '13C1'
df_p <- df[(df$Treatment==trt),]
df_p$"Voltage" <- as.factor(df_p$"Voltage")
df_p$"Replicate" <- as.factor(df_p$"Replicate")
# create a boxplot, grouped by voltage
ggplot(df_p, aes(x=Voltage, y=Velocity, colour=Channel)) +
geom_boxplot() +
# geom_point(position=position_jitterdodge())
labs(title=paste("Bacterial strain",trt,sep=" "), x="Voltage (V)", y = "Velocity (µm/s)")
# setwd(paste(path,"figs",sep="/"))
ggsave(paste(trt,".eps", sep=""), width = 5, height = 4, units = "in")
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from create_df.R
library("ggplot2")
library(tidyverse)
# subset df by each treatment
trt = 'ARW1R1'
df_p <- df[(df$Treatment==trt),]
df_p$"Voltage" <- as.factor(df_p$"Voltage")
df_p$"Replicate" <- as.factor(df_p$"Replicate")
# create a boxplot, grouped by voltage
ggplot(df_p, aes(x=Voltage, y=Velocity, colour=Channel)) +
geom_boxplot() +
# geom_point(position=position_jitterdodge())
labs(title=paste("Bacterial strain",trt,sep=" "), x="Voltage (V)", y = "Velocity (µm/s)")
# setwd(paste(path,"figs",sep="/"))
ggsave(paste(trt,".eps", sep=""), width = 5, height = 4, units = "in")
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Plots mean+-sd of EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
# mu_df_SE <- summarySE(
#   mu_df,
#   measurevar = 'Mobility', groupvars = 'Treatment'
#   ) # summarizes df by each treatment and replicate
#
# mu_df_SE %>%
#   mutate(Treatment = factor(Treatment, levels=trts)) %>%
#   ggplot( aes(x=Treatment, y=Mobility * 1e9)) +
#     geom_bar(stat="identity", position=position_dodge(), fill=NA, colour='black') +
#     # geom_errorbar(aes(ymin=(Mobility-sd)*1e9, ymax=(Mobility+sd)*1e9), width=.2) +
#     geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
#     labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Treatment = factor(Treatment, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Treatment, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Plots mean+-sd of EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
# mu_df_SE <- summarySE(
#   mu_df,
#   measurevar = 'Mobility', groupvars = 'Treatment'
#   ) # summarizes df by each treatment and replicate
#
# mu_df_SE %>%
#   mutate(Treatment = factor(Treatment, levels=trts)) %>%
#   ggplot( aes(x=Treatment, y=Mobility * 1e9)) +
#     geom_bar(stat="identity", position=position_dodge(), fill=NA, colour='black') +
#     # geom_errorbar(aes(ymin=(Mobility-sd)*1e9, ymax=(Mobility+sd)*1e9), width=.2) +
#     geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
#     labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Plots mean+-sd of EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
# mu_df_SE <- summarySE(
#   mu_df,
#   measurevar = 'Mobility', groupvars = 'Treatment'
#   ) # summarizes df by each treatment and replicate
#
# mu_df_SE %>%
#   mutate(Treatment = factor(Treatment, levels=trts)) %>%
#   ggplot( aes(x=Treatment, y=Mobility * 1e9)) +
#     geom_bar(stat="identity", position=position_dodge(), fill=NA, colour='black') +
#     # geom_errorbar(aes(ymin=(Mobility-sd)*1e9, ymax=(Mobility+sd)*1e9), width=.2) +
#     geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
#     labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(stroke = 0.2, size = 1, pch = 21, aes(colour = Channel))
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 <- mu_df[-mu_df$Channel=='16',]
mu_df$Channel
mu_df$Channel=='16'
mu_df2 <- mu_df[-(mu_df$Channel=='16'),]
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(stroke = 1, size = 3, pch = 21, aes(colour = Channel))
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(stroke = 1, size = 3, aes(shape = Channel))
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Plots mean+-sd of EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
mu_df2 <- mu_df[-(mu_df$Channel=='16'),]
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(stroke = 1, size = 3, aes(colour = Channel))
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(stroke = 1, size = 3, aes(colour = Channel)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC"))
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(stroke = 1, size = 3, aes(colour = Channel)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df[!(mu_df$Channel=='16'),]
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Plots mean+-sd of EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
mu_df2 <- mu_df[!(mu_df$Channel=='16'),]
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(stroke = 1, size = 3, aes(colour = Channel)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(stroke = 1, size = 3, aes(colour = Channel), position = position_jitter(width = .2)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(stroke = 1, size = 3, aes(colour = Channel), position = position_jitter(width = .3)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(size = 1, aes(colour = Channel), position = position_jitter(width = .3)) +
scale_fill_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(size = 2, aes(colour = Channel), position = position_jitter(width = .3)) +
scale_fill_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_jitter(size = 2, aes(colour = Channel), position = position_jitter(width = .3)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Conducts statistical t-test to compare mobility between treatements
mu_df2 <- mu_df[!(mu_df$Channel=='16'),]
trt_test <- c('3-2', '13C1')
str <- sprintf("t_%s-%s.txt", trt_test[1], trt_test[2])
res <- t.test(trt_test[1], trt_test[2], alternative='two.sided', paired=FALSE)
mu_df_test1 <- mu_df2[mu_df2$Strain==trt_test[1],]
mu_df_test2 <- mu_df2[mu_df2$Strain==trt_test[2],]
str <- sprintf("t_%s-%s.txt", trt_test[1], trt_test[2])
res <- t.test(mu_df_test1, mu_df_test1, alternative='two.sided', paired=FALSE)
summary(res)
summary(res)
sink(str)
print(summary(res))
sink()
res <- t.test(mu_df_test1, mu_df_test1, alternative='two.sided', paired=FALSE)
summary(res)
sink(str)
print(summary(res))
sink()
str <- sprintf("t_%s-%s.txt", trt_test[1], trt_test[2])
res2 <- t.test(mu_df_test1, mu_df_test1, alternative='two.sided', paired=FALSE)
summary(res2)
sink(str)
print(summary(res2))
sink()
source("~/Documents/GitHub/ek-ptv/R/t.R", echo=TRUE)
res2 <- t.test(mu_df_test1, mu_df_test2, alternative='two.sided', paired=FALSE)
trt_test <- c('3-2', '13C1')
mu_test1 <- mu_df2[mu_df2$Strain==trt_test[1],]$Mobility
mu_test2 <- mu_df2[mu_df2$Strain==trt_test[2],]$Mobility
str <- sprintf("t_%s-%s.txt", trt_test[1], trt_test[2])
res2 <- t.test(mu_test1, mu_test2, alternative='two.sided', paired=FALSE)
summary(res2)
sink(str)
print(summary(res2))
sink()
res2
str <- sprintf("t_%s-%s.txt", trt_test[1], trt_test[2])
res2 <- t.test(mu_test1, mu_test2, alternative='two.sided', paired=FALSE)
sink(str)
print(res2)
sink()
print('a'); print('b')
print(trt_test[1],' vs ', trt_test[2])
print(paste(trt_test[1],'vs', trt_test[2]))
str <- sprintf("t_%s-%s.txt", trt_test[1], trt_test[2])
res2 <- t.test(mu_test1, mu_test2, alternative='two.sided', paired=FALSE)
sink(str)
print(paste(trt_test[1],'vs', trt_test[2]))
print(res2)
sink()
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Conducts statistical t-test to compare mobility between treatements
mu_df2 <- mu_df[!(mu_df$Channel=='16'),]
trt_test <- c('13C1', 'ARW1R1')
mu_test1 <- mu_df2[mu_df2$Strain==trt_test[1],]$Mobility
mu_test2 <- mu_df2[mu_df2$Strain==trt_test[2],]$Mobility
str <- sprintf("t_%s-%s.txt", trt_test[1], trt_test[2])
res2 <- t.test(mu_test1, mu_test2, alternative='two.sided', paired=FALSE)
sink(str)
print(paste(trt_test[1],'vs', trt_test[2]))
print(res2)
sink()
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Conducts statistical t-test to compare mobility between treatements
mu_df2 <- mu_df[!(mu_df$Channel=='16'),]
trt_test <- c('13C1', '3-2')
mu_test1 <- mu_df2[mu_df2$Strain==trt_test[1],]$Mobility
mu_test2 <- mu_df2[mu_df2$Strain==trt_test[2],]$Mobility
str <- sprintf("t_%s-%s.txt", trt_test[1], trt_test[2])
res2 <- t.test(mu_test1, mu_test2, alternative='two.sided', paired=FALSE)
sink(str)
print(paste(trt_test[1],'vs', trt_test[2]))
print(res2)
sink()
getwd()
ggsave('mobility.eps', width = 4, height = 3.5, units = "in")
ggsave('mobility.eps', width = 5, height = 4, units = "in")
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.1),
aes(colour=Channel)) +
# geom_jitter(size = 2, aes(colour = Channel), position = position_jitter(width = .3)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(size = 2, position = position_jitterdodge(0.1),
aes(colour=Channel)) +
# geom_jitter(size = 2, aes(colour = Channel), position = position_jitter(width = .3)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
ggsave('mobility.eps', width = 5, height = 4, units = "in")
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(size = 2, position = position_jitterdodge(0.1),
aes(colour=Channel)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Bacterial strain', y=expression(paste('Mobility (','10'^{-9}, ' m'^2,'/ V-s)')))
ggsave('mobility.eps', width = 5, height = 4, units = "in")
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Conducts statistical t-test to compare mobility between treatements
mu_df2 <- mu_df[!(mu_df$Channel=='16'),]
trt_test <- c('ARW1R1', '3-2')
mu_test1 <- mu_df2[mu_df2$Strain==trt_test[1],]$Mobility
mu_test2 <- mu_df2[mu_df2$Strain==trt_test[2],]$Mobility
str <- sprintf("t_%s_vs_%s.txt", trt_test[1], trt_test[2])
res2 <- t.test(mu_test1, mu_test2, alternative='two.sided', paired=FALSE)
sink(str)
print(paste(trt_test[1],'vs', trt_test[2]))
print(res2)
sink()
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Plots EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
mu_df2 <- mu_df[!(mu_df$Channel=='16'),]
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(size = 2, position = position_jitterdodge(0.1),
aes(colour=Channel)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Bacterial strain', y=expression(paste('Mobility (','- 10'^{-9}, ' m'^2,'/ V-s)')))
ggsave('mobility.eps', width = 5, height = 4, units = "in")
getwd()
setwd("/Users/hk/Downloads")
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Plots EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
mu_df2 <- mu_df[!(mu_df$Channel=='16'),]
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(size = 2, position = position_jitterdodge(0.1),
aes(colour=Channel)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Bacterial strain', y=expression(paste('Mobility (','- 10'^{-9}, ' m'^2,'/ V-s)')))
ggsave('mobility.eps', width = 3.5, height = 3.5, units = "in")
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Plots EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
mu_df2 <- mu_df[!(mu_df$Channel=='16'),]
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(size = 2, position = position_jitterdodge(0.1),
aes(colour=Channel)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Bacterial strain', y=expression(paste('Mobility (','- 10'^{-9}, ' m'^2,'/ V-s)'))) +
theme(panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_rect(colour = "black", fill=NA, size=0.2))
ggsave('mobility.eps', width = 3.5, height = 3.5, units = "in")
# Created by Hyungseok Kim (hskimm@mit.edu), last modified on 2/18/22
# Continued from "create_df.R" THEN "lm.R"
# Plots EK mobility by each treatment
library("ggplot2")
library(tidyverse)
library(Rmisc)
mu_df2 <- mu_df[!(mu_df$Channel=='16'),]
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(size = 2, position = position_jitterdodge(0.1),
aes(colour=Channel)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Bacterial strain', y=expression(paste('Mobility (','- 10'^{-9}, ' m'^2,'/ V-s)'))) +
theme(panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_rect(colour = "black", fill=NA, size=0.1))
ggsave('mobility.eps', width = 3.5, height = 3.5, units = "in")
mu_df2 %>%
mutate(Strain = factor(Strain, levels=trts)) %>%
mutate(Channel = factor(Channel, levels=chls)) %>%
ggplot(aes(x=Strain, y=Mobility * 1e9)) +
geom_bar(stat = "summary", fun = mean, size = 0.2, width = 0.75, fill=NA, colour='black') +
geom_point(size = 2, position = position_jitterdodge(0.1),
aes(colour=Channel)) +
scale_color_manual(values=c("#FF0000", "#00FF0C", "#0812F7", "#B32222", "#06920D", "#0D7DA7", "#EE7230", "#81EF86", "#95DEEC")) +
# geom_point(stroke = 0.2, size = 1, pch = 21, position = position_jitterdodge(0.3)) +
labs(x='Bacterial strain', y=expression(paste('Mobility (','- 10'^{-9}, ' m'^2,'/ V-s)'))) +
theme(panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_rect(colour = "black", fill=NA, size=0.15))
ggsave('mobility.eps', width = 3.5, height = 3.5, units = "in")
